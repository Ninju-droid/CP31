#include <bits/stdc++.h>
using namespace std;
#define ll long long 

void fun(){ 
   ll n;
   cin>>n;
   vector<pair<ll,ll>>a(n);
   for(ll i=0;i<n;i++){
    ll in;
    cin>>in;
    a[i] = {in,i+1};
   }
   sort(a.rbegin(),a.rend());
   ll dis = 1;
   vector<ll>ans(n+1);
   ans[0] = 1;
   ll total =0;
   for(ll i=0;i<n;i++){
     ll index = a[i].second;
     ll times = a[i].first;
     if(i%2==0){
        ans[index] = ans[0]+dis;
        total = total + 2*dis*times;
     }
     else{
        ans[index]= ans[0]-dis;
        total = total + 2*dis*times;
        dis++;
     }
   }
   cout<<total<<endl;
   for(ll i=0;i<=n;i++){
    cout<<ans[i]<<" ";
   }
   cout<<endl;
}

int main() {
#ifndef ONLINE_JUDGE
    freopen("Input.txt", "r", stdin);
    freopen("Output.txt", "w", stdout);
#endif
    int t;
    cin >> t;
    while (t--) fun();
    return 0;
}
