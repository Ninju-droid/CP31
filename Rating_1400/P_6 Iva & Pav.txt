#include <bits/stdc++.h>
using namespace std;
#define ll long long 
#define endl '\n'
 
void fun(){
    int n;
    cin>>n;
    vector<ll>a(n);
    for(ll i=0;i<n;i++)cin>>a[i];
    vector<vector<ll>>bit(n+1,vector<ll>(31,0));  
    for(ll i=0;i<n;i++){
        for(ll j = 0;j<31;j++){
            if(a[i]&(1ll<<j))bit[i+1][j] = bit[i][j]+1;
            else bit[i+1][j]=bit[i][j];
        }
    } 
    ll q;cin>>q;
    while(q--){
        ll l,h;cin>>l>>h;
        ll ans = -1;
        ll r = n;
        ll left = l;
        while(left<=r){
            ll mid = left+(r-left)/2;
            ll sum = 0;
            for(ll i=0;i<30;i++){
                if(bit[mid][i]-bit[l-1][i]==mid-l+1){
                    sum+=(1ll<<i);
                }
            }
            if(sum>=h){
                ans = mid;
                left = mid+1;
            }
            else r = mid-1;
        }
        cout<<ans<<" ";
    }
cout<<endl;    
}
 
int main() {
    ios_base::sync_with_stdio(false);
    cin.tie(nullptr);
#ifndef ONLINE_JUDGE
    freopen("Input.txt", "r", stdin);
    freopen("Output.txt", "w", stdout);
#endif
    int t;
    cin >> t;
    while (t--) fun();
    return 0;
}