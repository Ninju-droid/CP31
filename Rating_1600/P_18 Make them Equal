#include <bits/stdc++.h>
using namespace std;

const int MOD = 1e9+7;
const int MAXN = 1e6 + 5;
#define ll long long
#define all(x) (x).begin(), (x).end()
#define allr(x) (x).rbegin(), (x).rend()
ll modpow(ll base, ll exp) {
    ll result = 1;
    base %= MOD;
    while (exp > 0) {
        if (exp & 1) result = (result * base) % MOD;
        base = (base * base) % MOD;
        exp >>= 1;
    }
    return result;
}
ll modinv(ll a){
    return modpow(a,MOD-2);
}
vector<ll> fact(MAXN);
void precomputeFact(){
    fact[0] = 1;
    for(int i=1; i<MAXN; i++){
        fact[i] = (fact[i-1]*i) % MOD;
    }
}
ll nCr(int n,int r){
    if(r>n || r<0) return 0;
    ll denom = (fact[r] * fact[n-r]) % MOD;
    return (fact[n]*modinv(denom)) % MOD;
}

void fun(){
   ll n,k;cin>>n>>k; 
   vector<ll>b(n),c(n);
   for(ll i=0;i<n;i++)cin>>b[i]; 
   for(ll j=0;j<n;j++)cin>>c[j]; 
   
   vector<ll> cost(1001, 1e9);
    cost[1] = 0;

    for (ll v = 1; v <= 1000; v++) {
        for (ll x = 1; x <= v; x++) {
            ll nv = v + v / x;
            if (nv <= 1000) {
                cost[nv] = min(cost[nv], cost[v] + 1);
            }
        }
    }
    for(ll i=0;i<n;i++){
        b[i] = cost[b[i]]; 
    }
    k = min(k,(ll)2e4); 
    vector<ll> dp(k+1, 0);

    for (ll i = 0; i < n; i++) {
     for (ll j = k; j >= b[i]; j--) {
            dp[j] = max(dp[j], dp[j - b[i]] + c[i]);
     }
    }
    cout << dp[k] << endl;
}

int main() {
#ifndef ONLINE_JUDGE
    freopen("Input.txt", "r", stdin);
    freopen("Output.txt", "w", stdout);
#endif  
   int t = 1;
   cin>>t;
   while(t--)fun(); 
   return 0 ; 
}

